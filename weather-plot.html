<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compact Weather Station</title>
<link rel="stylesheet" href="https://mr-hazmat.github.io/Portfolio/style.css">
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
<h1>Compact Weather Station</h1>
<div id="plot" style="width: 100%; height: 600px;"></div>

<script>
const csvUrl = "https://raw.githubusercontent.com/mr-hazmat/RPi_Compact-Weather-Station/main/docs/data.csv";

// Fetch CSV and plot
Plotly.d3.csv(csvUrl, function(err, rows) {
    if (err) {
        console.error("Failed to load CSV:", err);
        document.getElementById('plot').innerText = "Failed to load weather data.";
        return;
    }

    // Parse data
    const timestamps = rows.map(r => r.timestamp);
    const temp_c = rows.map(r => parseFloat(r.temp_c));
    const temp_f = rows.map(r => parseFloat(r.temp_f));
    const pressure = rows.map(r => parseFloat(r.pressure_hpa));
    const humidity = rows.map(r => parseFloat(r.humidity));

    // Prepare traces
    const data = [
        { x: timestamps, y: temp_c, type: 'scatter', mode:'lines+markers', name: 'Temp (°C)' },
        { x: timestamps, y: temp_f, type: 'scatter', mode:'lines+markers', name: 'Temp (°F)' },
        { x: timestamps, y: pressure, type: 'scatter', mode:'lines+markers', name: 'Pressure (hPa)' },
        { x: timestamps, y: humidity, type: 'scatter', mode:'lines+markers', name: 'Humidity (%)' }
    ];

    // Layout
    const layout = {
        title: 'Weather Station Data',
        xaxis: { title: 'Timestamp', tickangle: -45 },
        yaxis: { title: 'Values' },
        legend: { orientation: "h", y: -0.2 },
        margin: { t: 50, b: 50, l: 50, r: 50 }
    };

    Plotly.newPlot('plot', data, layout, {responsive: true});
});
</script>
</body>
</html>
